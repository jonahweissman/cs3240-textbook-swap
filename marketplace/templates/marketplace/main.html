{% extends 'marketplace/base.html' %}
{% block content %}

<div class="container">
    <br>
    <br>
    <div class="card bg-dark text-white">
  <img class="card-img" src="https://s26162.pcdn.co/wp-content/uploads/2017/12/covercover.jpg" alt="Card image">
  <div class="card-img-overlay">
      <br>
      <br>
      <br>
    <h1 class="display-3 text-center font-weight-bold bg-dark text-white">Welcome to Textbook Swap</h1>
      <br>
      <br>
      <br>
      <br>
    <h2 class="card-text bg-dark text-white text-center"><i>The marketplace to buy/sell textbooks with fellow Wahoos!</i></h2>


  </div>
</div>
  <div class="row">
    <div class="col">
        <h1 class="display-4 text-white">All Listings</h1>

        {% for items in allItems %}


		    <a href="{% url 'marketplace:item_detail' items.pk %}">
                {% if items.item_status == "Available" %}
<div class="card text-white bg-dark mb-3" style="max-width: 18rem;">
                        <div class="card-header text-white bg-success"><strong>Title: </strong>{{items.item_name}}</div>
                    <div class="card-body text-white">
                    {% if items.item_image  %}
                    <img src="{{ items.item_image.url }}" id="imgProfile" style="width: 100px; height: 100px" class= "img-thubmnail" align="middle"/>
                    {% else %}
                    <img src="static/marketplace/images/emptyTextbook.PNG" id="imgProfile" style="width: 100px; height: 100px" align="middle" class= "img-thubmnail"/>
                    {% endif %}
                        <br>

                        <strong> <font color="#00b300">Author:</font> </strong>{{items.item_author}} <br>
                        <strong><font color="#00b300">Course: </font></strong> {{items.item_course}}
                        <br>
                        <strong> <font color="#00b300">Edition: </font> </strong> {{items.item_edition}}
                        <br>
                        <style>
				#more{{ items.pk}}{display: none;}
                          </style>
			  <strong> <font color="#00b300">Info: </font> </strong> {%if items.item_description|length > 350 %} {{items.item_description|slice:":350"}}<span id= "dots{{ items.pk }}">...</span><span id="more{{ items.pk }}">{{items.item_description|slice:"350:"}}</span>
                      <br><a> <button onclick="viewMoreOrLess({{items.pk}})" class="btn btn-secondary btn-sm" id= "{{ items.pk }}" >Read more</button> </a>
                        {%else%} {{items.item_description}} {%endif%}
                        <br>
                        <strong><font color="#00b300">Price: </font></strong>${{ items.item_price }}
                        <br>
                        <strong><font color="#00b300">Status: </font></strong> {{ items.item_status }}
                        {% if items.item_seller_name.user.username == user.username %}
                        <br>
                        <a class="btn btn-outline-light btn-small" href="{% url 'marketplace:updateListing' items.pk %}">Update Status</a>
                        {%endif%}

                    </div>
                    </div>
		    </a>
        {%endif%}
        {% endfor %}

    </div>

    <div class="col">
      <h1 class="display-4 text-white">My Listings</h1>
        {% for items in allItems %}
            {% if items.item_seller_name.user.username == user.username %}
                {% if items.item_status == "Available" %}
                    <div class="card text-white bg-dark mb-3" style="max-width: 18rem;">
                        <div class="card-header text-white bg-success"><strong>Title: </strong>{{items.item_name}}</div>
                    <div class="card-body text-white">
                    {% if items.item_image  %}
                    <img src="{{ items.item_image.url }}" id="imgProfile" style="width: 100px; height: 100px" class= "img-thubmnail" align="middle"/>
                    {% else %}
                    <img src="static/marketplace/images/emptyTextbook.PNG" id="imgProfile" style="width: 100px; height: 100px" align="middle" class= "img-thubmnail"/>
                    {% endif %}
                        <br>

                        <strong> <font color="#00b300">Author:</font> </strong>{{items.item_author}} <br>
                        <strong><font color="#00b300">Course: </font></strong> {{items.item_course}}
                        <br>
                        <strong> <font color="#00b300">Edition: </font> </strong> {{items.item_edition}}
                        <br>
                        <style>
				#more{{ items.pk }}a {display: none;}
                            </style>
			    <strong> <font color="#00b300">Info: </font> </strong> {%if items.item_description|length > 350 %} {{items.item_description|slice:":350"}}<span id= "dots{{ items.pk }}a">...</span><span id="more{{ items.pk }}a"}}">{{items.item_description|slice:"350:"}}</span>
			    <br> <button onclick="viewMoreOrLess('{{ items.pk }}a')" class="btn btn-secondary btn-sm" id="{{ items.pk }}a" >Read more</button> 
                          {%else%} {{items.item_description}} {%endif%}
                        <br>
                        <strong><font color="#00b300">Price: </font></strong>${{ items.item_price }}
                        <br>
                        <strong><font color="#00b300">Status: </font></strong> {{ items.item_status }}

                        <br>
                        <a class="btn btn-outline-light btn-small" href="{% url 'marketplace:updateListing' items.pk %}">Update Status</a>
                        </div>
                    </div>
        {%endif%}
            {%endif%}


        {% endfor %}

</div>

{% endblock content %}
  </div>
</div>
